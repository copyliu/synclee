{% load thumbnail %}
<div class="timeline"  id="tweet_list">
	<!--#if expr="${nopost}" -->
	<!--#else -->
	<form class="timeline-update"  id="timeline-update" method="post">
		<textarea name="tweet_content" rows="10" cols="30" id="tweet_content"></textarea>
		<input name="submit" type="submit" value="刷屏"/>
	</form>
	<!--#endif -->
	<ol class="list">
		{% for n in notices.object_list %}
		<li class="status">
			<cite><a href="/{{n.sender.username}}/"><span class="image"><img class="avatar" src="/uploads/{% thumbnail n.sender.get_profile.avatar 40x38 %}"></span>{{n.sender.get_profile.get_name}}</a></cite>: <q>{{n.message|removetags:"iframe input script body html head title div style table td tr span h1 h2 h3 h4 h5 h6"|safe}}</q>
			<span class="meta"><a id="show_reply" class="show_reply" href="#">回复</a> | {% if n.notice_type.label == 'new_tweet' and n.recipient == user %}<a id="del_tweet" class="del_tweet" href="#" del_url="{{n.get_the_object.get_del_url}}">删除</a> | {% endif %}{{n.added|timesince}}前</span>
			
			<form class="timeline-reply" method="post" style="display:none" id="timeline-form">
				<input id="the_id" type="hidden" value="{{n.get_the_object.get_reply_url}}"/>
				<input name="reply_tweet" id="reply_tweet" rows="10" cols="30" type="text"/>
				<input name="submit" type="submit" value="回复"/>
			</form>
			
			{% if n.get_comments|length > 0 %}
			<ol class="many replies">
				{% for c in n.get_comments %}
					{% if forloop.counter < 10 %}
				<li><cite><a href="{% url People username=c.user.username %}"><span class="image"><img class="avatar" src="/uploads/{% thumbnail c.user.get_profile.avatar 24x24 %}"/></span></a></cite></li>
					{% endif %}
				{% endfor %}
				<li class="all"><a href="#">所有回复 ({{n.get_comments|length}})»</a></li>
			</ol>
			{% endif %}
		
			<ol class="replies" id="reply_sheet" style="display:none">
				{% for c in n.get_comments %}
				<li><cite><a href="/{{c.user.username}}/"><span class="image"><img class="avatar" src="/uploads/{% thumbnail c.user.get_profile.avatar 24x24 %}"/></span>{{c.user.get_profile.get_name}}</a></cite>: <q>{{c.content|removetags:"input button iframe script body html head title div style table td tr span h1 h2 h3 h4 h5 h6"|safe}}</q></li>
				{% endfor %}
			</ol>
		</li>
		{% empty %}
		<li class="status">
			还没有什么新鲜事
		</li>
		{% endfor %}
	</ol>
	{% include "inc/pager.html" %}
</div>
